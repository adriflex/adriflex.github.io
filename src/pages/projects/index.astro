---
import Base from '../../layouts/Base.astro';
import ProjectCard from '../../components/ProjectCard.astro';
import { getCollection } from 'astro:content';

const projects = await getCollection('projects', ({ data }) => data.status !== 'archived');
const sorted = projects.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
const toSlug = (id: string) => id.replace(/\.md$/, '');
---
<Base title="Projects" description="Tous les projets d'Adrien Rouquié — jeux, apps, outils, univers créatifs.">
  <section class="px-6 py-16 max-w-5xl mx-auto">

    <!-- En-tête -->
    <div class="mb-12">
      <div class="flex items-center gap-2 mb-4">
        <span class="w-8 h-px bg-accent"></span>
        <span class="text-sm font-body text-accent font-medium tracking-wide uppercase">Portfolio</span>
      </div>
      <h1 class="font-display text-5xl font-bold text-ink">Projects</h1>
      <p class="mt-3 font-body text-ink/60 max-w-md">Jeux, applications, outils, univers créatifs.</p>
    </div>

    <!-- Grille -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5">
      {sorted.map(p => (
        <ProjectCard
          title={p.data.title}
          description={p.data.description}
          slug={toSlug(p.id)}
          color={p.data.color}
          tags={p.data.tags}
          featured={p.data.featured}
        />
      ))}
    </div>

  </section>
</Base>
